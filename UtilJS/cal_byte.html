<!DOCTYPE html>
<html lang="en">
<!--
     @ 작성자 : 정  훈 
     @ 이메일 : manbalboy@hanmail.net 
     @ Git : https://github.com/manbalboy/toyScript   ,  http://manbalboy.iptime.org:30000/hjeong/toyscript
     @ Date : 2020.05.09
     @ 바이트 검사 
     @ TODO 
-->
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <script
    src="https://code.jquery.com/jquery-3.5.0.slim.min.js"
    integrity="sha256-MlusDLJIP1GRgLrOflUQtshyP0TwT/RHXsI1wWGnQhs="
    crossorigin="anonymous"></script>
    <script src="../hjeong.js"></script>
    <script>
        var calByte = {
            getByteLength : function(s) {

                if (s == null || s.length == 0) {
                    return 0;
                }
                var size = 0;

                for ( var i = 0; i < s.length; i++) {
                    size += this.charByteSize(s.charAt(i));
                }

                return size;
            },
                
            cutByteLength : function(s, len) {

                if (s == null || s.length == 0) {
                    return 0;
                }
                var size = 0;
                var rIndex = s.length;

                for ( var i = 0; i < s.length; i++) {
                    size += this.charByteSize(s.charAt(i));
                    if( size == len ) {
                        rIndex = i + 1;
                        break;
                    } else if( size > len ) {
                        rIndex = i;
                        break;
                    }
                }

                return s.substring(0, rIndex);
            },

            charByteSize : function(ch) {

                if (ch == null || ch.length == 0) {
                    return 0;
                }

                var charCode = ch.charCodeAt(0);

                if (charCode <= 0x00007F) {
                    return 1;
                } else if (charCode <= 0x0007FF) {
                    return 2;
                } else if (charCode <= 0x00FFFF) {
                    return 3;
                } else {
                    return 4;
                }
            }
        };

/* 
         charByteSize(ch) : 한글자에 대한 byte를 계산합니다.
         getByteLength(s) : 입력된 글자 전체의 byte를 계산해서 알려줍니다.
         cutByteLength(s) : 원하는 byte 만큼 글자를 잘라서 반환합니다. */

         function viewDisplay(obj) {
            $(".viewByte").html( calByte.getByteLength( obj.value ) );
            $(".view20Byte").html( calByte.cutByteLength( obj.value, 20 ) );
        }


    </script>
</head>
<body>

    <textarea name="contents" style="width:99%;height:100px;" onkeyup="viewDisplay(this)"></textarea>
    <p><span class="viewByte red"></span>byte입니다.</p>
    <p>20byte까지만 보여주기 : <span class="view20Byte red"></span></p>

    <p><br/></p>
    <p><br/></p>
    <p><br/></p>
    
</body>
</html>