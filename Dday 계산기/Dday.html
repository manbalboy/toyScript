<!DOCTYPE html>
<html lang="en">
    <!--
     @ 작성자 : 정  훈 
     @ 이메일 : manbalboy@hanmail.net 
     @ Git : https://github.com/manbalboy/toyScript   ,  http://manbalboy.iptime.org:30000/hjeong/toyscript
     @ Date : 2020.04.07
     @ D-DAY 계산기 Toy Project
     @ TODO = 유효성체크 View 타입 설정
-->
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<script src="../hjeong.js"></script>
<script>
    // D- day 계산 함수 
    function fn_makeDday () {
        var sVal = document.getElementById("Ddayinput").value
        console.log(sVal.substr(4,2))
        var Dday = new Date(sVal.substr(0,4), sVal.substr(4,2), sVal.substr(6,2));    // D-day(2017년 8월 30일)를 셋팅한다.
        var now = new Date();                    // 현재(오늘) 날짜를 받아온다.



        var distance = Dday - now;//디데이에서 현재까지 뺀다.
        var d = Math.floor(distance / (1000 * 60 * 60 * 24));//일

        var h = Math.floor((distance / (1000*60*60)) % 24);//시간
        var m = Math.floor((distance / (1000*60)) % 60);//분
        var s = Math.floor((distance / 1000) % 60);//초

        if (distance <= 0) {//당일넘어섰을때, dday로 변경
            document.getElementById('resultArea').innerHTML = "D-day";
        } else {
            document.getElementById("time-day").innerHTML = d + "일  "  + h + "시간  " + m + "분  " +s+"초 남았습니다.";
        }


    
        var gap = now.getTime() - Dday.getTime();    // 현재 날짜에서 D-day의 차이를 구한다.
        var result = Math.floor(gap / (1000 * 60 * 60 * 24)) * -1;    // gap을 일(밀리초 * 초 * 분 * 시간)로 나눈다. 이 때 -1 을 곱해야 날짜차이가 맞게 나온다.
        document.getElementById('resultArea').innerHTML="남은 날은 " + result + " 일 입니다.";
    };
</script>

<body>
    
    <span>20200101 형식으로 입력</span>
    <input type='text' value="" id="Ddayinput"/> <button id="inputCheckBtn" onclick="fn_makeDday()">계산</button>
    <div id="resultArea"></div>
    <div id="time-day"></div>
    <div id="time-hour"></div>
    <div id="time-minute"></div>
    <div id="time-second"></div>
    

    
</body>
</html>